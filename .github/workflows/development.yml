name: Development
cache:
  paths:
    - node_modules/
    - coverage/

stages:
  - install_n_build
  - tests
  - code-quality

on:
  pull_request:
    types:
      - opened
      - edited
      - synchronize
      - reopened
  workflow_call:

install:
  stage: install_n_build
  script:
    - npm i


unit-test:
  stage: tests
  script:
    - npm run test
  allow_failure: true

sonarqube-check:
  stage: code-quality
  script:
    - npm run run lint
  when: on_success
  only:
    - merge_requests
    - master
    - main
    - develop
